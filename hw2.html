<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Infovis HW2</title>
  <style>
  </style>
</head>
<body>
  <div id='menu'>
  </div>
  <div id='wrapper' style = 'display:inline'>
    <div id= 'table'style = 'display:inline;float:left'></div>
    <div id= 'line'style = 'display:inline;float:left'></div>
    <div id= 'bar'style = 'display:inline;float:left'></div>
  </div>
  
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script>
    function translate(x, y) {
      return 'translate(' + x + ',' + y + ')';
    }
    d3.json("data.json", function(data) {
      let str_data = JSON.stringify(data);
    let svgWidth = 550;
    let svgHeight = 550;
    let margin = {top: 30, right: 10, bottom: 20, left: 40, mid: 10};
    let width = svgWidth - margin.left - margin.right;
    let height = svgHeight - margin.top - margin.bottom;
    
    

    //domains of each menu
    let table_domain = [];
    data.forEach(function(value, index, array) {
      table_domain.push(data[index].year);
    });
    let line_domain = ['WR', 'DG'];
    let bar_domain = ['W', 'D', 'L'];
    
    //current options
    let selected_table = 1982;
    let selected_line = 'win_rate';
    let selected_bar = 'W';

    //initiate dropdown menu
    let menu_table = d3.select('#menu').append('select');
    let menu_line = d3.select('#menu').append('select');
    let menu_bar = d3.select('#menu').append('select');
    menu_table.selectAll('option')
      .data(table_domain)
      .enter()
      .append('option')
      .attr('value', d => d)
      .text(d => d);
    menu_line.selectAll('option')
      .data(line_domain)
      .enter()
      .append('option')
      .attr('value', d => d)
      .text(d => d);
    menu_bar.selectAll('option')
      .data(bar_domain)
      .enter()
      .append('option')
      .attr('value', d => d)
      .text(d => d);

    let target_data = data[0];
    let target_bar = target_data
    //change event handler
    menu_table.on('change', function(d) {
      selected_table = this.node().value;
      target_data = data.filter(d => d.year == selected);
    });

    menu_line.on('change', function(d) {
      selected_line = this.node().value;
      
    });

    menu_bar.on('change', function(d) {
      selected_bar = this.node().value;
     
    });

    


    //table
    let table_column = ['rank', 'team', 'W', 'D', 'L', 'win_rate', 'diff_game'];
    let svg_t = d3.select('#table')
    .append('svg')
    .attr('width', svgWidth)
    .attr('height', svgHeight)
    .append('g')
    .attr('transform', translate(margin.left, margin.top));

    svg_t.selectAll('text')
    .data(table_column)
    .enter()
    .append('text')
    .text(d => d)
    .attr('x', (d, i) =>  i*(svgWidth/table_column.length))
    //.attr('font-family', 'sans-serif')
    //.attr('font-size', '11px')
    .attr('fill', 'black')
    .attr('text-anchor', 'middle');

    let svg_l = d3.select('#line')
    .append('svg')
    .attr('width', svgWidth)
    .attr('height', svgHeight)
    .append('g')
    .attr('transform', translate(margin.left, margin.top));

    svg_l.selectAll('text')
    .data([str_data])
    .enter()
    .append('text')
    .text(d => d);

    let colorScale = d3.scaleOrdinal(d3.schemeCategory10);
    let svg_b = d3.select('#bar')
    .append('svg')
    .attr('width', svgWidth)
    .attr('height', svgHeight)
    .append('g')
    .attr('transform', translate(margin.left, margin.top));

    /*
    svg_b.selectAll('rect')
    .data(target_data)
    .enter()
    .append('rect')
    .attr('width', 40)
    .attr('height', d=>d.)
    .style('fill', (d, i) => colorScale(i));
    */
    });

    
    
  </script>
</body>
</html>